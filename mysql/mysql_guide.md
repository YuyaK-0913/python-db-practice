# MySQL Guide

## データベースへのログイン
- **MySQLのデータベースへのログイン**

    ```
    mysql -u <ユーザ名> -p -D <データベース名>
    ```
    - ```-p```オプションでパスワードを入力する際は，スペースが不要なので注意．

    ちなみに，SQLファイルを実行するときは，下記を実行すればよい．
    ```
    mysql -u <ユーザ名> -p -D <データベース名> < <SQLファイルのパス>
    ``` 
## MySQLの各ディレクトリの役割
- ```/docker-entrypoint-initdb.d```
    
    - **役割**
        
        MySQLコンテナの初回起動時にシェルスクリプトやSQLファイルを自動実行するためのディレクトリ。

    - **用途** 
    
        通常，データベースの初期化処理やテーブル作成，データインポートなどに使用する．
    
    - **ファイル実行順**

        ファイルは数字順・アルファベット順に実行されるため，ファイル名の先頭に番号をつけることで実行順序を制御可能（例：01_create_database.sql、02_insert_data.sql）．

- ```/etc/mysql/conf.d/my.cnf```
    
    - **役割**
    
        MySQLの追加設定ファイルを格納するディレクトリ．
    
    - **用途** 
        
        my.cnf（MySQLの設定ファイル）を置くことで，コンテナ内のMySQLの動作をカスタマイズ可能．例えば，SQLモードの変更やタイムゾーンの設定，接続に関するパラメータの変更などを行うことが可能．
    
    - **設定の適用タイミング**
        
        my.cnfの変更内容は，MySQLの再起動時に適用される．設定ファイルが「全ユーザー書き込み可能（ワールドライト）」になっているとMySQLは設定ファイルを無視するため，```chmod 644```で権限を調整する必要があり．

- ```/var/lib/mysql-files/```
    
    - **役割**

        MySQLサーバーがアクセスできるファイル格納用のディレクトリ。
    
    - **用途** 
        
        ```LOAD DATA INFILE```や```SELECT INTO OUTFILE```のようなコマンドで、ファイル操作が必要な場合に使用する．このディレクトリにCSVファイルやデータファイルを配置し，テーブルへのデータインポートやエクスポートを行う．

    - **アクセス制限** 

        デフォルトでMySQLはセキュリティの観点から、```secure_file_priv```変数で```/var/lib/mysql-files/```のみにファイルアクセスを制限している．

        - ちなみに```secure_file_priv```に登録されているディレクトリは，下記のコマンドで確認可能．
            
            ```mysql
            SHOW VARIABLES LIKE 'secure_file_priv';
            ```
            または
            ```mysql
            select @@global.secure_file_priv;
            ```
            実行すると，下記のような結果が出力される．
            ```
            +---------------------------+
            | @@global.secure_file_priv |
            +---------------------------+
            | /var/lib/mysql-files/     |
            +---------------------------+
            1 row in set (0.00 sec)」
            ```





